openapi: 3.0.0
info:
  title: Consent-Manager
  version: '1.0'
  description: Consent Manager
  contact: {}
  license:
    name: MIT
servers:
  - url: 'http://localhost:3000'
paths:
  /consent/userinfo:
    post:
      summary: Complete User Information
      operationId: post-consent-userinfo
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: object
                    additionalProperties: false
                    properties:
                      id:
                        type: string
                        format: uuid
                      name:
                        type: string
                      email:
                        type: string
                      organization:
                        type: string
                      address:
                        type: string
                      entity:
                        type: string
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      id: 530f4c2b-bc4c-4c4a-bddb-31c1ab2343fb
                      name: AIP Person
                      email: aip.person@example.com
                      organization: Internet Widgits Pty Ltd
                      address: 'Some-Place, Some-State'
                      entity: Some entity
        '409':
          description: User Info already exists.
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:AlreadyExists'
                    title: User info already added
                    detail: The user information for this user has been obtained
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:AlreadyExists'
                    title: User info already added
                    detail: The user information for this user has been obtained
      description: Add relevant user information to the consent manager APD. This step must be completed before trying to use any other APIs of the consent manager.
      security:
        - IUDX AAA Identity Token: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                organization:
                  type: string
                  minLength: 1
                address:
                  type: string
                  minLength: 1
                entity:
                  type: string
                  enum:
                    - CORPORATION
                    - NOT FOR PROFIT
                    - UNIVERSITY
                    - GOVERNMENT DEPARTMENT
                    - PRESS
                    - INDIVIDUAL
                  minLength: 1
              required:
                - organization
                - address
                - entity
            examples:
              Example 1:
                value:
                  organization: Internet Widgits Pty Ltd
                  address: 'Some-Place, Some-State'
                  entity: CORPORATION
      tags:
        - User Info API
    parameters: []
    get:
      summary: Get User Info
      operationId: get-consent-userinfo
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: object
                    properties:
                      id:
                        type: string
                      name:
                        type: string
                      email:
                        type: string
                      organization:
                        type: string
                      address:
                        type: string
                      entity:
                        type: string
                x-examples:
                  Example 1:
                    type: string
                    title: string
                    results:
                      id: 530f4c2b-bc4c-4c4a-bddb-31c1ab2343fb
                      name: AIP Person
                      email: aip.person@example.com
                      organization: Internet Widgits Pty Ltd
                      address: 'Some-Place, Some-State'
                      entity: CORPORATION
        '401':
          description: User Info not present
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
      security:
        - IUDX AAA Identity Token: []
      description: Get User info if already registered on the consent manager APD
      tags:
        - User Info API
  /consent/purposes:
    parameters: []
    get:
      summary: 'Get all purposes - AIU, AIP'
      operationId: get-consent-purposes
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Purpose'
                required:
                  - type
                  - title
                  - results
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      - id: 2174e669-82dd-4053-be23-e69a8ecb6d94
                        code: B1
                        name: Agricultural credit
                        description: |-
                          - Assessment of credit worthiness and extension of short,medium, and long-term loans to farmers and the associated processes like recovery.
                          - Extending credit to farmers basing on NegotiableWarehouse Receipts (NWR)
      description: Get all purposes that can be used to create a consent form.
      security:
        - IUDX AAA Identity Token: []
      tags:
        - Purposes APIs
  /consent/forms:
    parameters: []
    get:
      summary: View consent forms - AIP
      operationId: get-consent-forms
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Consent-Form'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                        name: Consent Form 124320943
                        itemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
                        itemType: resource_group
                        itemName: title
                        purposes:
                          - id: 2174e669-82dd-4053-be23-e69a8ecb6d94
                            code: B1
                            name: Agricultural credit
                            description: |-
                              - Assessment of credit worthiness and extension of short,medium, and long-term loans to farmers and the associated processes like recovery.
                              - Extending credit to farmers basing on NegotiableWarehouse Receipts (NWR)
                        dataPrincipals:
                          - id: baa153a1-a7f7-469b-b6cd-f7fa4581c65e
                            ppbNo: T13010130532
                            name: Farmer
                        expiryDuration: P1Y
                        consentFormStats:
                          artifacts: 0
                          dataPrincipals: 0
        '401':
          description: User info not present
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
        '403':
          description: Invalid user role to call API
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:InvalidRole'
                    title: Not permitted
                    detail: Only AIPs may use this API
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:InvalidRole'
                    title: Not permitted
                    detail: Only AIPs may use this API
      description: AIP views all consent forms they have created
      tags:
        - Consent Form APIs
      security:
        - IUDX AAA Identity Token: []
      parameters: []
    post:
      summary: Create consent form - AIP
      operationId: post-consent-forms
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    $ref: '#/components/schemas/Consent-Form'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                      name: Consent Form 124320943
                      itemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
                      itemType: resource_group
                      purposes:
                        - id: 2174e669-82dd-4053-be23-e69a8ecb6d94
                          code: B1
                          name: Agricultural credit
                          description: |-
                            - Assessment of credit worthiness and extension of short,medium, and long-term loans to farmers and the associated processes like recovery.
                            - Extending credit to farmers basing on NegotiableWarehouse Receipts (NWR)
                      dataPrincipals:
                        - id: baa153a1-a7f7-469b-b6cd-f7fa4581c65e
                          ppbNo: T13010130532
                          name: Farmer
                      expiryDuration: P1Y
                      consentFormStats:
                        artifacts: 0
                        dataPrincipals: 0
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:InvalidInput'
                    title: Item not a PII RESOURCE
                    detail: string
              examples:
                Invalid expiryDuration:
                  value:
                    type: 'urn:dx:as:InvalidInput'
                    title: Invalid expiryDuration
                    detail: Invalid expiryDuration
                Invalid Purposes:
                  value:
                    type: 'urn:dx:as:InvalidInput'
                    title: Invalid Purposes
                    detail: Some purposes may not exist
                invalid data principals:
                  value:
                    type: 'urn:dx:as:InvalidInput'
                    title: Invalid Data Principals
                    detail: Some data principals may not exist / may not be verified
                invalid access policy:
                  value:
                    type: 'urn:dx:as:InvalidInput'
                    title: Item not a PII RESOURCE
                    detail: string
        '401':
          description: User info not added
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
        '403':
          description: Invalid role to perform operation / User does not own resource
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:InvalidRole'
                    title: Not permitted
                    detail: Only AIPs may use this API
              examples:
                Invalid Role:
                  value:
                    type: 'urn:dx:as:InvalidRole'
                    title: Not permitted
                    detail: Only AIPs may use this API
                'User does not own resource ':
                  value:
                    type: 'urn:dx:as:InvalidInput'
                    title: User does not own resource
                    detail: Cannot create consent form as the user does not own the resource
        '409':
          description: Form already exists
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:AlreadyExists'
                    title: Consent form already exists for resource
                    detail: A consent form 0403826b-f435-4acf-985f-561e0a250115 already exists for the resource
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:AlreadyExists'
                    title: Consent form already exists for resource
                    detail: A consent form 0403826b-f435-4acf-985f-561e0a250115 already exists for the resource
      description: AIP users can Create a consent form for a resource/resource_group that they own
      security:
        - IUDX AAA Identity Token: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              additionalProperties: false
              properties:
                name:
                  type: string
                purposes:
                  type: array
                  items:
                    $ref: '#/components/schemas/PurposeCode'
                dataPrincipals:
                  type: array
                  minItems: 1
                  maxItems: 1
                  description: PPB numbers
                  items:
                    $ref: '#/components/schemas/PPBNo'
                itemId:
                  type: string
                  description: cat ID of resource
                itemType:
                  type: string
                  enum:
                    - resource_group
                    - resource
                expiryDuration:
                  type: string
                  pattern: '^(-?)P(?=\d|T\d)(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)([DW]))?(?:T(?:(\d+)H)?(?:(\d+)M)?(?:(\d+(?:\.\d+)?)S)?)?$'
              required:
                - name
                - purposes
                - dataPrincipals
                - itemId
                - itemType
                - expiryDuration
            examples:
              Example 1:
                value:
                  name: Consent Form 124320943
                  purposes:
                    - B1
                  dataPrincipals:
                    - T13010130532
                  itemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
                  itemType: resource_group
                  expiryDuration: P1Y
        description: |-
          `name` : name of the form to be created.

          `purposes`: array of codes of the purposes that a user can use a resource for.

          `dataPrincipals` : PPBnos of the farmer whose consent the provider has already obtained.

          `itemId`: catalogue id of the resource for which the AIP has obtained consent.

          `itemType`: resource or resource_group

          `expiryDuration`: the duration for which artifacts created with this form are valid for.
      tags:
        - Consent Form APIs
    patch:
      summary: Update an existing consent form - AIP
      operationId: patch-consent-forms
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Consent-Form'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                        name: Consent Form 124320943
                        itemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
                        itemType: resource_group
                        purposes:
                          - id: 2174e669-82dd-4053-be23-e69a8ecb6d94
                            code: B1
                            name: Agricultural credit
                            description: |-
                              - Assessment of credit worthiness and extension of short,medium, and long-term loans to farmers and the associated processes like recovery.
                              - Extending credit to farmers basing on NegotiableWarehouse Receipts (NWR)
                        dataPrincipals:
                          - id: baa153a1-a7f7-469b-b6cd-f7fa4581c65e
                            ppbNo: T13010130532
                            name: Farmer
                        expiryDuration: P1M5D
                        consentFormStats:
                          artifacts: 0
                          dataPrincipals: 0
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:InvalidInput'
                    title: Invalid Consent Form ID
                    detail: Some IDs may not exist/not be active
              examples:
                invalid form id:
                  value:
                    type: 'urn:dx:as:InvalidInput'
                    title: Invalid Consent Form ID
                    detail: Some IDs may not exist/not be active
                '':
                  value:
                    type: string
                    title: string
                    detail: string
                Invalid ppbno:
                  value:
                    type: 'urn:dx:as:InvalidInput'
                    title: Invalid PPbNos
                    detail: Some PPBNos may not exist/not be active
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
        '403':
          description: Invalid user role to call API
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:InvalidRole'
                    title: Not permitted
                    detail: Only AIPs may use this API
              examples:
                Invalid role:
                  value:
                    type: 'urn:dx:as:InvalidRole'
                    title: Not permitted
                    detail: Only AIPs may use this API
      description: |-
        Updates an existing consent form.
        the following fields can be updated
        - purposes
        - data principals
        - expiry duration

        **NOTE**   : all fields in the exisiting form will be replaced by the values of the fields in the request
      security:
        - IUDX AAA Identity Token: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              additionalProperties: false
              properties:
                formId:
                  type: string
                  format: uuid
                purposes:
                  type: array
                  minItems: 1
                  items:
                    $ref: '#/components/schemas/PurposeCode'
                dataPrincipals:
                  type: array
                  description: PPB numbers
                  minItems: 1
                  items:
                    $ref: '#/components/schemas/PPBNo'
                expiryDuration:
                  type: string
                  pattern: '^(-?)P(?=\d|T\d)(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)([DW]))?(?:T(?:(\d+)H)?(?:(\d+)M)?(?:(\d+(?:\.\d+)?)S)?)?$'
              required:
                - formId
                - purposes
                - dataPrincipals
                - expiryDuration
            examples:
              Example 1:
                value:
                  formId: 126460ed-49b2-4c69-849a-bd8904ec5d8f
                  purposes:
                    - B1
                  dataPrincipals:
                    - T13010130532
                  expiryDuration: P1M5D
        description: |-
          `formId` UUID of the form that is to be updated.

          `purposes`: array of codes of purposes.

          `dataPrincipals` : array of PPBnos.

          `expiryDuration` : Duration of validity of the consent artifact created using the consent form.
      tags:
        - Consent Form APIs
    delete:
      summary: Deactivate consent forms - AIP
      operationId: delete-consent-forms
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Consent-Form'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                        name: Consent Form 124320943
                        itemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
                        itemType: resource_group
                        purposes:
                          - id: 2174e669-82dd-4053-be23-e69a8ecb6d94
                            code: B1
                            name: Agricultural credit
                            description: |-
                              - Assessment of credit worthiness and extension of short,medium, and long-term loans to farmers and the associated processes like recovery.
                              - Extending credit to farmers basing on NegotiableWarehouse Receipts (NWR)
                        expiryDuration: P1Y
                        dataPrincipals:
                          - id: baa153a1-a7f7-469b-b6cd-f7fa4581c65e
                            ppbNo: T13010130532
                            name: Farmer
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
        '403':
          description: Invalid user role to call API/ invalid form ID
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:InvalidRole'
                    title: Not permitted
                    detail: Only AIPs may use this API
              examples:
                Invalid Role:
                  value:
                    type: 'urn:dx:as:InvalidRole'
                    title: Not permitted
                    detail: Only AIPs may use this API
                Form is not active/ not owned by the AIP:
                  value:
                    type: 'urn:dx:as:InvalidInput'
                    title: Invalid Consent Form IDs
                    detail: Some IDs may not exist/not be active
                    ids: []
      description: 'Deactivate list of consent forms. Additionally, all consent artifacts associated with the consent forms can be **optionally revoked**.'
      security:
        - IUDX AAA Identity Token: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              additionalProperties: false
              properties:
                revokeConsentArtifacts:
                  type: boolean
                formIds:
                  type: array
                  format: uuid
                  items:
                    type: string
                    format: uuid
              required:
                - revokeConsentArtifacts
                - formIds
            examples:
              Example 1:
                value:
                  revokeConsentArtifacts: true
                  formIds:
                    - a4263677-9531-46c9-8acd-1f2c9a9200da
      tags:
        - Consent Form APIs
  /consent/forms/search:
    post:
      summary: Search for resource + data principal - AIU
      tags:
        - Consent Form APIs
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    $ref: '#/components/schemas/Consent-Form-Search'
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:Success'
                    title: Consent Form
                    results:
                      id: 30c66b93-4b54-4d4c-b359-1ec07e24ae62
                      name: form_8
                      purposes:
                        - code: P2
                          description: '- The entire range of personalised advisory services required for enhancing the production, productivity, and profitability of the farmer, including those relating to weather, inputs and good agricultural practices (GAP). - Digital extension services \n'
                          id: 47cc4b97-a27a-46a2-8a17-7a3ab4a6fdd4
                          name: Farm advisories
                        - code: B5
                          description: '- Enabling the producers to access the markets – physical or digital – for selling of their produce.- Providing personalised services relating to the sale of the produce, including hyper-local market intelligence. \n'
                          id: 4e932d50-aecc-4925-9a5f-a8adcdb043b1
                          name: Market-related services
                        - code: G2
                          description: '- Maintenance of land records and record of rights on land - Creation and maintenance of cadastral records specifying the field boundaries of agricultural parcels, digital form including geo-referencing, using GIS and GPS \n'
                          id: f5215989-f903-44b0-8f8d-50ccb7a3dabb
                          name: Land Records
                      dataPrincipals:
                        - id: 00231147-9ad5-4577-802e-c43a04404c6f
                          ppbNo: T13010030220
                          name: రసం శకుంతలా
                      expiryDuration: 1 year
                      createdAt: '2023-03-06T14:03:12.535917'
                      updatedAt: '2023-03-06T14:03:12.535931'
                      effectiveItemId: datakaveri.org/5841d4c98a9ef8ab708e01a3c5fc1ab955e6ada0/rs.iudx.io/resGrp8
                      effectiveItemType: resource_group
                      aip:
                        id: e958f1ad-13ee-40b5-a3e6-ef8f974afb5d
                        email: test.aip@datakaveri.org
                        name: Test AIP
                        organization: Internet Widgits Pty Ltd
                        address: 'Some-Place, Some-State'
                        entity: CORPORATION
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
              examples:
                itemtype mismatch:
                  value:
                    type: 'urn:dx:as:InvalidInput'
                    title: Invalid itemtype
                    detail: itemType mismatch
                Invalid PPbNos:
                  value:
                    type: 'urn:dx:as:InvalidInput'
                    title: Invalid PPBNOs
                    results:
                      dataPrincipal: T1301013052
                    detail: Some IDs may not exist
                item does not exist:
                  value:
                    type: 'urn:dx:as:InvalidInput'
                    title: Item does not exist
                    detail: string
                Not a PII resource:
                  value:
                    type: 'urn:dx:as:InvalidInput'
                    title: Item not a PII RESOURCE
                    detail: string
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
        '403':
          description: Invalid user role to call API
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:InvalidRole'
                    title: Not permitted
                    detail: Only AIPs may use this API
              examples:
                Invalid Role:
                  value:
                    type: 'urn:dx:as:InvalidRole'
                    title: Not permitted
                    detail: Only AIUs may use this API
                Not present:
                  value:
                    type: 'urn:dx:as:InvalidInput'
                    title: Invalid request
                    results:
                      itemId: datakaveri.org/089abba8-9a80-4e41-b6cb-ab396fc2273a/rs.iudx.io/resGrp0
                      itemType: resource_group
                      dataPrincipal: T13010130532
                    detail: No consent form found
        '404':
          description: Item Not Found
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:InvalidRole'
                    title: Not permitted
                    detail: Only AIUs may use this API
              examples:
                Item Not Found:
                  value:
                    type: 'urn:dx:as:InvalidInput'
                    title: Item does not exist
                    detail: string
      operationId: post-consent-forms-search
      description: 'AIU can search if a consent form exists for a given resource and data principal '
      security:
        - IUDX AAA Identity Token: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              additionalProperties: false
              properties:
                itemId:
                  type: string
                itemType:
                  type: string
                  enum:
                    - resource_group
                    - resource
                dataPrincipal:
                  $ref: '#/components/schemas/PPBNo'
              required:
                - itemId
                - itemType
                - dataPrincipal
            examples:
              Example 1:
                value:
                  itemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
                  itemType: resource_group
                  dataPrincipal: T13010130532
  /consent/artifacts:
    get:
      summary: 'Get all consent artifacts - AIP, AIU'
      tags:
        - Consent Artifact APIs
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Consent-Artifact'
              examples:
                Listing artifacts (output has both active and revoked artifacts):
                  value:
                    type: string
                    title: string
                    results:
                      - id: ee3f7aff-9306-41b6-b4dc-67ea751511f2
                        aiu:
                          id: 2ad34eb1-9934-4128-b3d8-acad37d0574d
                          name: AIU Person
                          email: aiu.person@example.com
                        aip:
                          id: 530f4c2b-bc4c-4c4a-bddb-31c1ab2343fb
                          name: AIP Person
                          email: aip.person@example.com
                        dataPrincipal:
                          id: baa153a1-a7f7-469b-b6cd-f7fa4581c65e
                          ppbNo: T13010130532
                          name: Farmer
                        purposes:
                          - id: 2174e669-82dd-4053-be23-e69a8ecb6d94
                            code: B1
                            name: Agricultural credit
                            description: |-
                              - Assessment of credit worthiness and extension of short,medium, and long-term loans to farmers and the associated processes like recovery.
                              - Extending credit to farmers basing on NegotiableWarehouse Receipts (NWR)
                        itemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
                        itemType: resource_group
                        itemName: title
                        status: active
                        expiry: '2027-08-24T14:15:22Z'
                        createdAt: '2019-08-24T14:15:22Z'
                        updatedAt: '2019-08-24T14:15:22Z'
                        consentArtifactStats:
                          accessLogs: 0
                      - id: 9b3bf126-a4f2-4e09-b9b5-6055fb0d3dcb
                        aiu:
                          id: 2ad34eb1-9934-4128-b3d8-acad37d0574d
                          name: AIU Person
                          email: aiu.person@example.com
                        aip:
                          id: 530f4c2b-bc4c-4c4a-bddb-31c1ab2343fb
                          name: AIP Person
                          email: aip.person@example.com
                        dataPrincipal:
                          id: baa153a1-a7f7-469b-b6cd-f7fa4581c65e
                          ppbNo: T13010130532
                          name: Farmer
                        purposes:
                          - id: 2174e669-82dd-4053-be23-e69a8ecb6d94
                            code: B1
                            name: Agricultural credit
                            description: |-
                              - Assessment of credit worthiness and extension of short,medium, and long-term loans to farmers and the associated processes like recovery.
                              - Extending credit to farmers basing on NegotiableWarehouse Receipts (NWR)
                        itemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group/resource
                        itemType: resource
                        itemName: title2
                        status: revoked
                        revocation:
                          id: 5781251b-add0-43a0-b9b8-d48e0bebc65c
                          revokedBy:
                            id: 530f4c2b-bc4c-4c4a-bddb-31c1ab2343fb
                            name: AIP Person
                            email: aip.person@example.com
                            role: AIP
                          revokedAt: '2023-01-20T14:15:22Z'
                        expiry: '2027-08-24T14:15:22Z'
                        createdAt: '2019-08-24T14:15:22Z'
                        updatedAt: '2023-01-20T14:15:22Z'
                        consentArtifactStats:
                          accessLogs: 500
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
      operationId: get-consent-artifacts
      description: |-
        # AIP
        Get all consent artifacts for resources they own

        # AIU
        Get all consent artifacts created for them
      security:
        - IUDX AAA Identity Token: []
      parameters: []
    post:
      summary: Create consent artifact - AIU
      operationId: post-consent-artifacts
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    $ref: '#/components/schemas/Consent-Artifact'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      id: ee3f7aff-9306-41b6-b4dc-67ea751511f2
                      aiu:
                        id: 2ad34eb1-9934-4128-b3d8-acad37d0574d
                        name: AIU Person
                        email: aiu.person@example.com
                      aip:
                        id: 530f4c2b-bc4c-4c4a-bddb-31c1ab2343fb
                        name: AIP Person
                        email: aip.person@example.com
                      dataPrincipal:
                        id: baa153a1-a7f7-469b-b6cd-f7fa4581c65e
                        ppbNo: T13010130532
                        name: Farmer
                      purposes:
                        - id: 2174e669-82dd-4053-be23-e69a8ecb6d94
                          code: B1
                          name: Agricultural credit
                          description: |-
                            - Assessment of credit worthiness and extension of short,medium, and long-term loans to farmers and the associated processes like recovery.
                            - Extending credit to farmers basing on NegotiableWarehouse Receipts (NWR)
                      itemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
                      itemType: resource_group
                      status: active
                      expiry: '2027-08-24T14:15:22Z'
                      createdAt: '2019-08-24T14:15:22Z'
                      updatedAt: '2019-08-24T14:15:22Z'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:InvalidInput'
                    title: Invalid form ID
                    detail: The form ID does not exist / not active
              examples:
                Invalid Form Id:
                  value:
                    type: 'urn:dx:as:InvalidInput'
                    title: Invalid form ID
                    detail: The form ID does not exist / not active
                Invalid data principal:
                  value:
                    type: 'urn:dx:as:InvalidInput'
                    title: Invalid data principal
                    detail: The data principal does not exist / has not been verified
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
        '403':
          description: Invalid user role to call API
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:InvalidRole'
                    title: Not permitted
                    detail: Only AIUs may use this API
              examples:
                Invalid Role:
                  value:
                    type: 'urn:dx:as:InvalidRole'
                    title: Not permitted
                    detail: Only AIUs may use this API
                Already exists:
                  value:
                    type: 'urn:dx:as:InvalidInput'
                    title: Consent Artifact already exists
                    detail: An active and un-expired consent artifact already exists for data principal and resource
                    context:
                      artifactId: dd380942-d26d-4b1c-9efb-a87e2f89ac06
                form does not exist:
                  value:
                    type: 'urn:dx:as:InvalidInput'
                    title: Invalid form ID
                    detail: The form ID does not exist / not active
      description: AIU tries to create a consent artifact for a resource + data principal. Purposes are taken from the form ID associated.
      security:
        - IUDX AAA Identity Token: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              additionalProperties: false
              properties:
                itemId:
                  type: string
                  description: Cat ID of requested resource
                itemType:
                  type: string
                  enum:
                    - resource_group
                    - resource
                dataPrincipal:
                  $ref: '#/components/schemas/PPBNo'
                formId:
                  type: string
                  format: uuid
              required:
                - itemId
                - itemType
                - dataPrincipal
                - formId
            examples:
              Example 1:
                value:
                  itemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
                  itemType: resource_group
                  dataPrincipal: T13010130532
                  formId: 497f6eca-6276-4993-bfeb-53cbbbba6f08
        description: ''
      tags:
        - Consent Artifact APIs
    delete:
      summary: 'Revoke consent artifact - AIP, AIU'
      operationId: delete-consent-artifacts
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Consent-Artifact'
              examples:
                Example 1:
                  value:
                    type: string
                    title: Revoked consent artifacts
                    results:
                      - id: ee3f7aff-9306-41b6-b4dc-67ea751511f2
                        aiu:
                          id: 2ad34eb1-9934-4128-b3d8-acad37d0574d
                          name: AIU Person
                          email: aiu.person@example.com
                        aip:
                          id: 530f4c2b-bc4c-4c4a-bddb-31c1ab2343fb
                          name: AIP Person
                          email: aip.person@example.com
                        dataPrincipal:
                          id: baa153a1-a7f7-469b-b6cd-f7fa4581c65e
                          ppbNo: T13010130532
                          name: Farmer
                        purposes:
                          - id: 2174e669-82dd-4053-be23-e69a8ecb6d94
                            code: B1
                            name: Agricultural credit
                            description: |-
                              - Assessment of credit worthiness and extension of short,medium, and long-term loans to farmers and the associated processes like recovery.
                              - Extending credit to farmers basing on NegotiableWarehouse Receipts (NWR)
                        itemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
                        itemType: resource_group
                        status: revoked
                        revocation:
                          id: b68eae1e-9c52-454e-80d7-a64d1ce706e9
                          revokedBy:
                            id: 530f4c2b-bc4c-4c4a-bddb-31c1ab2343fb
                            name: AIP Person
                            email: aip.person@example.com
                            role: AIP
                          revokedAt: '2023-01-24T14:15:22Z'
                        expiry: '2027-08-24T14:15:22Z'
                        createdAt: '2019-08-24T14:15:22Z'
                        updatedAt: '2023-01-24T14:15:22Z'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:InvalidInput'
                    title: Invalid Consent Artifact IDs
                    detail: Some IDs may not exist/not be active
              examples:
                Invalid artifactID: {}
      description: |-
        # AIP
        Revoke consent artifacts

        # AIU
        Revoke consent artifacts
      security:
        - IUDX AAA Identity Token: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              additionalProperties: false
              properties:
                artifactIds:
                  type: array
                  uniqueItems: true
                  minItems: 1
                  maxItems: 100
                  items:
                    type: string
                    format: uuid
            examples:
              Example 1:
                value:
                  artifactIds:
                    - ee3f7aff-9306-41b6-b4dc-67ea751511f2
      tags:
        - Consent Artifact APIs
  /consent/principals:
    get:
      summary: 'Get data principals - AIP, AIU'
      tags:
        - Data Principal APIs
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Data-Principal'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      - id: baa153a1-a7f7-469b-b6cd-f7fa4581c65e
                        ppbNo: T13010130532
                        name: Farmer
                        dataPrincipalStats:
                          artifacts: 4
                          accessLogs: 9
        '201':
          description: Created
        '400':
          description: Bad Request
        '401':
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
          description: Unauthorized
      operationId: get-consent-principals
      description: |-
        # AIP

        Get all data principals present in consent forms of AIP

        # AIU

        Get all data principals present in consent artifacts of AIU
      security:
        - IUDX AAA Identity Token: []
      parameters: []
    delete:
      summary: 'Revoke consent for data principals - AIP, AIU'
      operationId: delete-consent-principals
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Data-Principal'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      - id: baa153a1-a7f7-469b-b6cd-f7fa4581c65e
                        ppbNo: T13010130532
                        name: Farmer
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
        '403':
          description: PPBnos have no associated forms/artifact
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
              examples:
                No associated forms/artifacts:
                  value:
                    type: 'urn:dx:as:InvalidInput'
                    title: Invalid PPBNOs
                    detail: Nothing to delete
      description: |-
        # AIP
        AIPs can revoke consent for a DP
        - removes them from all **consent forms** the AIP owns
        - revokes all **consent artifacts** the DP is part of

        # AIU
        AIUs can revoke consent for a DP
        - revokes all **consent artifacts** the DP and AIU is part of
      requestBody:
        content:
          application/json:
            schema:
              type: object
              additionalProperties: false
              properties:
                dataPrincipals:
                  type: array
                  description: UUID or PPB?
                  items:
                    $ref: '#/components/schemas/PPBNo'
            examples:
              Example 1:
                value:
                  dataPrincipals:
                    - T13010130532
      security:
        - IUDX AAA Identity Token: []
      tags:
        - Data Principal APIs
    post:
      summary: Verify PPB Numbers - AIP
      operationId: post-consent-principals
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: object
                    properties:
                      verified:
                        type: array
                        items:
                          $ref: '#/components/schemas/PPBNo'
                      unverified:
                        type: array
                        items:
                          $ref: '#/components/schemas/PPBNo'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      verified:
                        - T13010130532
                      unverified:
                        - T13010130000
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
        '403':
          description: Invalid user role to call API
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:InvalidRole'
                    title: Not permitted
                    detail: Only AIPs may use this API
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:InvalidRole'
                    title: Not permitted
                    detail: Only AIPs may use this API
      description: |-
        Verify set of PPB numbers. PPB numbers are used to identify data principals.

        The API response will contain PPB numbers that were successfully verified and those that were unverified in 2 JSON arrays, `verified` and `unverified` respectively. The verified PPB numbers represent real data principals and can be used in consent form creation.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                ppbNumbers:
                  type: array
                  minItems: 1
                  maxItems: 500
                  uniqueItems: true
                  items:
                    $ref: '#/components/schemas/PPBNo'
            examples:
              Example 1:
                value:
                  ppbNumbers:
                    - T13010130532
                    - T13010130000
      security:
        - IUDX AAA Identity Token: []
      tags:
        - Data Principal APIs
  /consent/artifacts/download:
    post:
      summary: 'Download consent artifact - AIP, AIU'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    $ref: '#/components/schemas/Download-Consent-Artifact'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      artifact:
                        id: ee3f7aff-9306-41b6-b4dc-67ea751511f2
                        aiu:
                          id: 2ad34eb1-9934-4128-b3d8-acad37d0574d
                          name: AIU Person
                          email: aiu.person@example.com
                        aip:
                          id: 530f4c2b-bc4c-4c4a-bddb-31c1ab2343fb
                          name: AIP Person
                          email: aip.person@example.com
                        dataPrincipal:
                          id: baa153a1-a7f7-469b-b6cd-f7fa4581c65e
                          ppbNo: T13010130532
                          name: Farmer
                        purposes:
                          - id: 2174e669-82dd-4053-be23-e69a8ecb6d94
                            code: B1
                            name: Agricultural credit
                            description: |-
                              - Assessment of credit worthiness and extension of short,medium, and long-term loans to farmers and the associated processes like recovery.
                              - Extending credit to farmers basing on NegotiableWarehouse Receipts (NWR)
                        itemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
                        itemType: resource_group
                        status: revoked
                        expiry: '2027-08-24T14:15:22Z'
                        createdAt: '2019-08-24T14:15:22Z'
                        updatedAt: '2023-01-24T14:15:22Z'
                      signedArtifact: {}
                      revocation:
                        id: b68eae1e-9c52-454e-80d7-a64d1ce706e9
                        revokedBy:
                          id: 530f4c2b-bc4c-4c4a-bddb-31c1ab2343fb
                          name: AIP Person
                          email: aip.person@example.com
                          role: AIP
                        artifact: d314337b-6c0d-4d0e-a3b2-d6fc0160357d
                        signedRevocation: {}
                      accessLogs:
                        - id: ab55b457-5047-41f3-81f2-05b21ff6ebd1
                          artifact: ee3f7aff-9306-41b6-b4dc-67ea751511f2
                          createdAt: '2022-08-24T14:15:22Z'
                          signedAccessLog: {}
                          effectiveItemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
                          effectiveItemType: resource_group
            application/pdf:
              schema:
                type: string
                format: binary
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
      operationId: post-consent-artifacts-download
      tags:
        - Consent Artifact APIs
      description: |-
        # AIP

        Download a consent artifact with it's access logs artifacts and revocation artifact if applicable

        # AIU

        Download a consent artifact with it's access logs artifacts and revocation artifact if applicable
      security:
        - IUDX AAA Identity Token: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              additionalProperties: false
              properties:
                artifactId:
                  type: string
                  format: uuid
              required:
                - artifactId
            examples:
              Example 1:
                value:
                  artifactId: ee3f7aff-9306-41b6-b4dc-67ea751511f2
  /consent/aius:
    get:
      summary: Get AIUs - AIPs
      tags:
        - AIU APIs
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/AIU'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      - id: 2ad34eb1-9934-4128-b3d8-acad37d0574d
                        name: AIU Person
                        email: aiu.person@example.com
                        aiuStats:
                          artifacts: 0
                          accessLogs: 0
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
        '403':
          description: Invalid user role to call API
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:InvalidRole'
                    title: Not permitted
                    detail: Only AIPs may use this API
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:InvalidRole'
                    title: Not permitted
                    detail: Only AIPs may use this API
      operationId: get-consent-aius
      description: AIPs can get all AIUs that have consent artifacts for their consent forms
      security:
        - IUDX AAA Identity Token: []
    delete:
      summary: Revoke artifacts of AIUs - AIPs
      operationId: delete-consent-aius
      responses:
        '200':
          description: Returns list of revoked artifacts?
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Consent-Artifact'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      - id: ee3f7aff-9306-41b6-b4dc-67ea751511f2
                        aiu:
                          id: 2ad34eb1-9934-4128-b3d8-acad37d0574d
                          name: AIU Person
                          email: aiu.person@example.com
                        aip:
                          id: 530f4c2b-bc4c-4c4a-bddb-31c1ab2343fb
                          name: AIP Person
                          email: aip.person@example.com
                        dataPrincipal:
                          id: baa153a1-a7f7-469b-b6cd-f7fa4581c65e
                          ppbNo: T13010130532
                          name: Farmer
                        purposes:
                          - id: 2174e669-82dd-4053-be23-e69a8ecb6d94
                            code: B1
                            name: Agricultural credit
                            description: |-
                              - Assessment of credit worthiness and extension of short,medium, and long-term loans to farmers and the associated processes like recovery.
                              - Extending credit to farmers basing on NegotiableWarehouse Receipts (NWR)
                        itemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
                        itemType: resource_group
                        status: revoked
                        expiry: '2027-08-24T14:15:22Z'
                        createdAt: '2019-08-24T14:15:22Z'
                        updatedAt: '2023-01-24T14:15:22Z'
                        consentArtifactStats:
                          accessLogs: 0
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
        '403':
          description: Invalid user role to call API
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:InvalidRole'
                    title: Not permitted
                    detail: Only AIPs may use this API
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:InvalidRole'
                    title: Not permitted
                    detail: Only AIPs may use this API
      description: AIPs can send a list of AIUs whose artifacts must be revoked for forms they have created
      security:
        - IUDX AAA Identity Token: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              additionalProperties: false
              properties:
                aiuIds:
                  type: array
                  items:
                    type: string
                    format: uuid
            examples:
              Example 1:
                value:
                  aiuIds:
                    - 2ad34eb1-9934-4128-b3d8-acad37d0574d
      tags:
        - AIU APIs
  /consent/logs:
    get:
      summary: Get artifact access logs - AIP
      tags:
        - Access Log APIs
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Access-Log'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      - id: ab55b457-5047-41f3-81f2-05b21ff6ebd1
                        artifact:
                          id: ee3f7aff-9306-41b6-b4dc-67ea751511f2
                          aiu:
                            id: 2ad34eb1-9934-4128-b3d8-acad37d0574d
                            name: AIU Person
                            email: aiu.person@example.com
                          aip:
                            id: 530f4c2b-bc4c-4c4a-bddb-31c1ab2343fb
                            name: AIP Person
                            email: aip.person@example.com
                          dataPrincipal:
                            id: baa153a1-a7f7-469b-b6cd-f7fa4581c65e
                            ppbNo: T13010130532
                            name: Farmer
                          purposes:
                            - id: 2174e669-82dd-4053-be23-e69a8ecb6d94
                              code: B1
                              name: Agricultural credit
                              description: |-
                                - Assessment of credit worthiness and extension of short,medium, and long-term loans to farmers and the associated processes like recovery.
                                - Extending credit to farmers basing on NegotiableWarehouse Receipts (NWR)
                          itemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
                          itemType: resource_group
                          itemName: title
                          status: active
                          expiry: '2027-08-24T14:15:22Z'
                          createdAt: '2019-08-24T14:15:22Z'
                          updatedAt: '2019-08-24T14:15:22Z'
                        createdAt: '2022-08-24T14:15:22Z'
                        effectiveItemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
                        effectiveItemType: resource_group
                        effectiveItemName: Title
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:as:MissingInformation'
                    title: Missing user information
                    detail: Please visit /consent/userinfo to add user information for consent manager
      operationId: get-consent-logs
      parameters: []
      security:
        - IUDX AAA Identity Token: []
  /userclasses:
    get:
      summary: Get all User Classes
      tags:
        - APD APIs
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  userclasses:
                    type: array
                    items:
                      type: object
                      properties:
                        name:
                          type: string
                        description:
                          type: string
              examples:
                Example:
                  value:
                    userclasses:
                      - name: 'urn:apd:consent.apd.io:hasConsent'
                        description: User has consent to access resource
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: string
                    title: string
                    detail: string
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    detail: string
      operationId: get-userclasses
      description: 'Get all applicable user classes. '
  /verify:
    post:
      summary: Verify user has consent
      operationId: post-verify
      responses:
        '200':
          description: The user has consent
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  constraints:
                    type: string
              examples:
                Example 1:
                  value:
                    type: 'urn:apd:Allow'
                    constraints: {}
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:as:MissingAuthenticationToken'
                    title: Missing token
                    detail: No token sent
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    detail: string
        '403':
          description: User does not have consent
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  detail:
                    type: string
              examples:
                Example 1:
                  value:
                    type: 'urn:apd:Deny'
                    title: User does not have consent
                    detail: Contact APD to obtain consent
      tags:
        - APD APIs
      description: '**This API is ONLY called by the DX AAA Server to check if a given user has consent to access a resource**'
      security:
        - DX Auth Server Token: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                user:
                  type: object
                  properties:
                    id:
                      type: string
                    name:
                      type: object
                      properties:
                        firstName:
                          type: string
                        lastName:
                          type: string
                    email:
                      type: string
                owner:
                  type: object
                  properties:
                    id:
                      type: string
                    name:
                      type: object
                      properties:
                        firstName:
                          type: string
                        lastName:
                          type: string
                    email:
                      type: string
                item:
                  type: object
                  properties:
                    itemId:
                      type: string
                    itemType:
                      type: string
                userClass:
                  type: string
              x-examples:
                Example 1:
                  user:
                    id: <iudx user ID>
                    name:
                      firstName: ''
                      lastName: ''
                    email: ''
                  owner:
                    id: <iudx user ID>
                    name:
                      firstName: ''
                      lastName: ''
                    email: ''
                  item:
                    itemId: vmc.com/<>/rs.iudx.io/resource
                    itemType: ''
                  userClass: something
            examples: {}
  /consent/agreements:
    get:
      summary: 'Get agreements - AIP, AIU'
      tags:
        - Agreement APIs
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    x-stoplight:
                      id: zfoeorzh51c9z
                  title:
                    type: string
                    x-stoplight:
                      id: jsvehaqirv9nv
                  results:
                    type: array
                    x-stoplight:
                      id: hdf30kdgekate
                    items:
                      $ref: '#/components/schemas/Agreement'
                      x-stoplight:
                        id: 49wsuufqg9iwz
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      - id: string
                        aiu:
                          id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                          name: string
                          email: string
                          aiuStats:
                            artifacts: 0
                            accessLogs: 0
                        aip:
                          id: string
                          name: string
                          email: string
                        purposes:
                          - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                            code: B1
                            name: string
                            description: string
                        itemId: string
                        itemType: string
                        itemName: string
                        status: string
                        expiryDuration: string
                        createdAt: string
                        updatedAt: string
      operationId: get-consent-agreements
      security:
        - IUDX AAA Identity Token: []
    post:
      summary: Create agreement - AIU
      operationId: post-consent-agreements
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    x-stoplight:
                      id: yswvnj5ffwiyg
                  title:
                    type: string
                    x-stoplight:
                      id: rdvvbhln2q1bd
                  results:
                    $ref: '#/components/schemas/Agreement'
                    x-stoplight:
                      id: wqd9w6571o5yh
      tags:
        - Agreement APIs
      security:
        - IUDX AAA Identity Token: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                itemId:
                  type: string
                  x-stoplight:
                    id: l0j9clavrvzdx
                itemType:
                  type: string
                  x-stoplight:
                    id: 55ksu5osy5o49
                  enum:
                    - resource
                    - resource_group
                expiryDuration:
                  type: string
                  x-stoplight:
                    id: 8pax2n2eolhr6
                purposes:
                  type: array
                  x-stoplight:
                    id: nchi436tqwsr7
                  items:
                    $ref: '#/components/schemas/PurposeCode'
                    x-stoplight:
                      id: dq7gilmxpyqr3
              required:
                - itemId
                - itemType
                - expiryDuration
                - purposes
            examples:
              Example 1:
                value:
                  itemId: string
                  itemType: resource
                  expiryDuration: string
                  purposes:
                    - B1
    put:
      summary: Approve/reject agreement - AIP
      operationId: put-consent-agreements
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    x-stoplight:
                      id: qkx1x6btx0hjg
                  title:
                    type: string
                    x-stoplight:
                      id: 66ytrz9xmrygm
                  results:
                    type: array
                    x-stoplight:
                      id: sf2rssq5vkn7l
                    items:
                      $ref: '#/components/schemas/Agreement'
                      x-stoplight:
                        id: 3xnsiv3kxhpk0
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      - id: string
                        aiu:
                          id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                          name: string
                          email: string
                        aip:
                          id: string
                          name: string
                          email: string
                        purposes:
                          - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                            code: B1
                            name: string
                            description: string
                        itemId: string
                        itemType: string
                        itemName: string
                        status: string
                        expiryDuration: string
                        createdAt: string
                        updatedAt: string
      tags:
        - Agreement APIs
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                request:
                  type: array
                  x-stoplight:
                    id: 2dvslfrraekl9
                  minItems: 1
                  maxItems: 100
                  uniqueItems: true
                  items:
                    x-stoplight:
                      id: 29i8bsw65i4zh
                    type: object
                    additionalProperties: false
                    properties:
                      agreementId:
                        type: string
                        x-stoplight:
                          id: ymc688qv04vyi
                        format: uuid
                      status:
                        type: string
                        x-stoplight:
                          id: fqsatokh5fho0
                        enum:
                          - approved
                          - rejected
                    required:
                      - agreementId
                      - status
              required:
                - request
            examples:
              Example 1:
                value:
                  request:
                    - agreementId: 79458f91-82b5-4c38-a886-56df6a6b7980
                      status: approved
      security:
        - IUDX AAA Identity Token: []
    delete:
      summary: Withdraw pending agreement - AIU / Revoke agreement - AIP
      operationId: delete-consent-agreements
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    x-stoplight:
                      id: 8aixt7jmzffzd
                  title:
                    type: string
                    x-stoplight:
                      id: cvbkivyd3p5w9
                  results:
                    type: array
                    x-stoplight:
                      id: ao0d4iw3vt75b
                    items:
                      $ref: '#/components/schemas/Agreement'
                      x-stoplight:
                        id: bgu4t5osu1e3x
      tags:
        - Agreement APIs
      security:
        - IUDX AAA Identity Token: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                request:
                  type: array
                  x-stoplight:
                    id: i3kxbkjm720mi
                  minItems: 1
                  uniqueItems: true
                  items:
                    x-stoplight:
                      id: vgnvfhsroirsv
                    type: object
                    properties:
                      agreementId:
                        type: string
                        x-stoplight:
                          id: sws9z7q0y4i23
                        format: uuid
                    required:
                      - agreementId
              required:
                - request
            examples:
              Example 1:
                value:
                  request:
                    - agreementId: 79458f91-82b5-4c38-a886-56df6a6b7980
  /consent/agreements/download:
    post:
      summary: Download agreement as PDF
      operationId: post-consent-agreements-download
      responses:
        '200':
          description: OK
          content:
            application/pdf:
              schema:
                type: string
                format: binary
      security:
        - IUDX AAA Identity Token: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                agreementId:
                  type: string
                  x-stoplight:
                    id: a3kq84z4wtdgn
                  format: uuid
              required:
                - agreementId
            examples:
              Example 1:
                value:
                  agreementId: 79458f91-82b5-4c38-a886-56df6a6b7980
components:
  schemas:
    Consent-Form:
      title: Consent-Form
      x-stoplight:
        id: ti854s4kspqie
      type: object
      x-tags:
        - Consent Form Model
      description: Consent form external view
      x-examples:
        Example 1:
          id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
          name: Consent Form 124320943
          itemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
          itemType: resource_group
          itemName: Title
          purposes:
            - id: 2174e669-82dd-4053-be23-e69a8ecb6d94
              code: B1
              name: Agricultural credit
              description: |-
                - Assessment of credit worthiness and extension of short,medium, and long-term loans to farmers and the associated processes like recovery.
                - Extending credit to farmers basing on NegotiableWarehouse Receipts (NWR)
          dataPrincipals:
            - id: baa153a1-a7f7-469b-b6cd-f7fa4581c65e
              ppbNo: T13010130532
              name: Farmer
          expiryDuration: P1Y
          consentFormStats:
            artifacts: 0
            dataPrincipals: 0
      properties:
        id:
          type: string
          description: UUID ID of form
          format: uuid
        name:
          type: string
          description: Simple name of form
        itemId:
          type: string
          description: Cat ID of resource
        itemType:
          type: string
          description: Type of resource
          enum:
            - resource_group
            - resource
        itemName:
          type: string
          x-stoplight:
            id: w6rmg8pib6x0i
        purposes:
          type: array
          description: List of purposes
          items:
            $ref: '#/components/schemas/Purpose'
        dataPrincipals:
          type: array
          items:
            $ref: '#/components/schemas/Data-Principal'
        expiryDuration:
          type: string
          description: How long a consent artefact generated from thisform will last
          pattern: '^(-?)P(?=\d|T\d)(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)([DW]))?(?:T(?:(\d+)H)?(?:(\d+)M)?(?:(\d+(?:\.\d+)?)S)?)?$'
        consentFormStats:
          $ref: '#/components/schemas/Consent-Form-Stats'
      required:
        - id
        - name
        - itemId
        - itemType
        - purposes
        - expiryDuration
    Consent-Form-Stats:
      title: Consent-Form-Stats
      x-stoplight:
        id: 32u08fgjwdk85
      type: object
      description: 'Stats for a consent form '
      x-tags:
        - Consent Form Model
      properties:
        artifacts:
          type: integer
        dataPrincipals:
          type: integer
      x-examples:
        Example 1:
          artifacts: 100
          dataPrincipals: 2
    PurposeCode:
      title: PurposeCode
      x-stoplight:
        id: a3gdxlwhpe33h
      type: string
      description: Allowed codes for ADeX purposes
      x-examples:
        Example 1: B1
      example: B1
      enum:
        - B1
        - B2
        - B3
        - B4
        - B5
        - B6
        - P1
        - P2
        - P3
        - P4
        - P5
        - G1
        - G2
        - G3
        - G4
        - G5
        - G6
      x-tags:
        - Purpose Model
    Purpose:
      title: Purpose
      x-stoplight:
        id: jyhjlpu5iug53
      type: object
      x-tags:
        - Purpose Model
      properties:
        id:
          type: string
          description: UUID ID of purpose
          format: uuid
        code:
          $ref: '#/components/schemas/PurposeCode'
        name:
          type: string
        description:
          type: string
      required:
        - id
        - code
        - name
      description: ''
      x-examples:
        Example 1:
          id: 2174e669-82dd-4053-be23-e69a8ecb6d94
          code: B1
          name: Agricultural credit
          description: |-
            - Assessment of credit worthiness and extension of short,medium, and long-term loans to farmers and the associated processes like recovery.
            - Extending credit to farmers basing on NegotiableWarehouse Receipts (NWR)
    Data-Principal-Stats:
      title: Data-Principal-Stats
      x-stoplight:
        id: rff0j8ljamfv8
      type: object
      x-tags:
        - Data Principal Model
      properties:
        artifacts:
          type: integer
        accessLogs:
          type: integer
      x-examples:
        Example 1:
          artifacts: 0
          accessLogs: 0
    Data-Principal:
      title: Data-Principal
      x-stoplight:
        id: ydql93jmjxe2a
      type: object
      x-tags:
        - Data Principal Model
      properties:
        id:
          type: string
          description: UUID ID of data principal
          format: uuid
        ppbNo:
          $ref: '#/components/schemas/PPBNo'
        name:
          type: string
          description: Name in English
        dataPrincipalStats:
          $ref: '#/components/schemas/Data-Principal-Stats'
      required:
        - id
        - ppbNo
        - name
      x-examples:
        Example 1:
          id: baa153a1-a7f7-469b-b6cd-f7fa4581c65e
          ppbNo: T13010130532
          name: Farmer
          dataPrincipalStats:
            artifacts: 4
            accessLogs: 9
    PPBNo:
      title: PPBNo
      x-stoplight:
        id: 31lsvpan6jmty
      type: string
      description: A PPB number
      example: T13010130532
      x-examples:
        Example 1: T13010130532
      pattern: '^(?=.{11,12}$)[TR][A-Z0-9].*$'
    AIU:
      title: AIU
      x-stoplight:
        id: 30c8733454a35
      type: object
      x-tags:
        - AIU Model
      properties:
        id:
          type: string
          description: IUDX user ID of AIU
          format: uuid
        name:
          type: string
        email:
          type: string
        aiuStats:
          $ref: '#/components/schemas/AIU-Stats'
      required:
        - id
        - name
        - email
      x-examples:
        Example 1:
          id: 2ad34eb1-9934-4128-b3d8-acad37d0574d
          name: AIU Person
          email: aiu.person@example.com
          aiuStats:
            artifacts: 0
            accessLogs: 0
    AIU-Stats:
      title: AIU-Stats
      x-stoplight:
        id: ojnrtjbu9ojop
      type: object
      x-tags:
        - AIU Model
      properties:
        artifacts:
          type: integer
        accessLogs:
          type: integer
      x-examples:
        Example 1:
          artifacts: 4
          accessLogs: 1
    AIP:
      title: AIP
      x-stoplight:
        id: h80aoxodvm5r8
      type: object
      x-tags:
        - AIP Model
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        email:
          type: string
      required:
        - id
        - name
        - email
      x-examples:
        Example 1:
          id: 530f4c2b-bc4c-4c4a-bddb-31c1ab2343fb
          name: AIP Person
          email: aip.person@example.com
    Consent-Artifact:
      title: Consent-Artifact
      x-stoplight:
        id: q0amvhva2o2fb
      type: object
      x-tags:
        - Consent Artifact Model
      x-examples:
        Example 1:
          id: ee3f7aff-9306-41b6-b4dc-67ea751511f2
          aiu:
            id: 2ad34eb1-9934-4128-b3d8-acad37d0574d
            name: AIU Person
            email: aiu.person@example.com
          aip:
            id: 530f4c2b-bc4c-4c4a-bddb-31c1ab2343fb
            name: AIP Person
            email: aip.person@example.com
          dataPrincipal:
            id: baa153a1-a7f7-469b-b6cd-f7fa4581c65e
            ppbNo: T13010130532
            name: Farmer
          purposes:
            - id: 2174e669-82dd-4053-be23-e69a8ecb6d94
              code: B1
              name: Agricultural credit
              description: |-
                - Assessment of credit worthiness and extension of short,medium, and long-term loans to farmers and the associated processes like recovery.
                - Extending credit to farmers basing on NegotiableWarehouse Receipts (NWR)
          itemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
          itemType: resource_group
          itemName: title
          status: active
          expiry: '2027-08-24T14:15:22Z'
          createdAt: '2019-08-24T14:15:22Z'
          updatedAt: '2019-08-24T14:15:22Z'
          consentArtifactStats:
            accessLogs: 0
      description: 'If the artifact is revoked, `revocation` is also included in the model'
      properties:
        id:
          type: string
          description: UUID ID of artifact
          format: uuid
        aiu:
          $ref: '#/components/schemas/AIU'
        aip:
          $ref: '#/components/schemas/AIP'
        dataPrincipal:
          $ref: '#/components/schemas/Data-Principal'
        purposes:
          type: array
          items:
            $ref: '#/components/schemas/Purpose'
        itemId:
          type: string
        itemType:
          type: string
          enum:
            - resource_group
            - resource
        itemName:
          type: string
          enum:
            - resource_group
            - resource
          x-stoplight:
            id: d52wkgr8wcp2e
        status:
          type: string
          enum:
            - active
            - revoked
        expiry:
          type: string
          format: date-time
        revocation:
          $ref: '#/components/schemas/Revocation'
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        consentArtifactStats:
          $ref: '#/components/schemas/Consent-Artifact-Stats'
      required:
        - id
        - aiu
        - aip
        - dataPrincipal
        - purposes
        - itemId
        - itemType
        - itemName
        - status
        - expiry
        - createdAt
        - updatedAt
    Consent-Artifact-Stats:
      title: Consent-Artifact-Stats
      x-stoplight:
        id: vimv51qjgikhf
      type: object
      x-tags:
        - Consent Artifact Model
      properties:
        accessLogs:
          type: integer
      x-examples:
        Example 1:
          accessLogs: 0
    Access-Log:
      title: Access-Log
      x-stoplight:
        id: 863xx35dw6y26
      type: object
      x-tags:
        - Access Log Model
      x-examples:
        Access Log when downloaded in POST /consent/artifacts/download:
          id: ab55b457-5047-41f3-81f2-05b21ff6ebd1
          artifact: ee3f7aff-9306-41b6-b4dc-67ea751511f2
          createdAt: '2022-08-24T14:15:22Z'
          signedAccessLog: {}
          effectiveItemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
          effectiveItemType: resource_group
        Access Log when listed in GET /consent/logs:
          id: ab55b457-5047-41f3-81f2-05b21ff6ebd1
          artifact:
            id: ee3f7aff-9306-41b6-b4dc-67ea751511f2
            aiu:
              id: 2ad34eb1-9934-4128-b3d8-acad37d0574d
              name: AIU Person
              email: aiu.person@example.com
            aip:
              id: 530f4c2b-bc4c-4c4a-bddb-31c1ab2343fb
              name: AIP Person
              email: aip.person@example.com
            dataPrincipal:
              id: baa153a1-a7f7-469b-b6cd-f7fa4581c65e
              ppbNo: T13010130532
              name: Farmer
            purposes:
              - id: 2174e669-82dd-4053-be23-e69a8ecb6d94
                code: B1
                name: Agricultural credit
                description: |-
                  - Assessment of credit worthiness and extension of short,medium, and long-term loans to farmers and the associated processes like recovery.
                  - Extending credit to farmers basing on NegotiableWarehouse Receipts (NWR)
            itemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
            itemType: resource_group
            status: active
            expiry: '2027-08-24T14:15:22Z'
            createdAt: '2019-08-24T14:15:22Z'
            updatedAt: '2019-08-24T14:15:22Z'
            consentArtifactStats:
              accessLogs: 0
          createdAt: '2022-08-24T14:15:22Z'
          effectiveItemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
          effectiveItemType: resource_group
          effectiveItemName: Title
      properties:
        id:
          type: string
          format: uuid
        artifact:
          oneOf:
            - type: string
              format: uuid
            - $ref: '#/components/schemas/Consent-Artifact'
        createdAt:
          type: string
          format: date-time
        signedAccessLog:
          type: object
        effectiveItemId:
          type: string
        effectiveItemType:
          type: string
          enum:
            - resource_group
            - resource
        effectiveItemName:
          type: string
          enum:
            - resource_group
            - resource
          x-stoplight:
            id: oifbys5ma3pfd
      required:
        - id
        - artifact
        - createdAt
        - effectiveItemId
        - effectiveItemType
        - effectiveItemName
    Consent-Form-Search:
      title: Consent-Form-Search
      x-stoplight:
        id: hr5tg674z8wgh
      type: object
      x-tags:
        - Consent Artifact Model
      x-examples:
        Example 1:
          id: 30c66b93-4b54-4d4c-b359-1ec07e24ae62
          name: form_8
          purposes:
            - code: P1
              description: '- The entire range of personalised advisory services required for enhancing the production, productivity, and profitability of the farmer, including those relating to weather, inputs and good agricultural practices (GAP). - Digital extension services \n'
              id: 47cc4b97-a27a-46a2-8a17-7a3ab4a6fdd4
              name: Farm advisories
            - code: B5
              description: '- Enabling the producers to access the markets – physical or digital – for selling of their produce.- Providing personalised services relating to the sale of the produce, including hyper-local market intelligence. \n'
              id: 4e932d50-aecc-4925-9a5f-a8adcdb043b1
              name: Market-related services
            - code: G2
              description: '- Maintenance of land records and record of rights on land - Creation and maintenance of cadastral records specifying the field boundaries of agricultural parcels, digital form including geo-referencing, using GIS and GPS \n'
              id: f5215989-f903-44b0-8f8d-50ccb7a3dabb
              name: Land Records
          dataPrincipals:
            - id: 00231147-9ad5-4577-802e-c43a04404c6f
              ppbNo: T13010030220
              name: రసం శకుంతలా
          expiryDuration: 1 year
          createdAt: '2023-03-06T14:03:12.535917'
          updatedAt: '2023-03-06T14:03:12.535931'
          effectiveItemId: datakaveri.org/5841d4c98a9ef8ab708e01a3c5fc1ab955e6ada0/rs.iudx.io/resGrp8
          effectiveItemType: resource_group
          aip:
            id: e958f1ad-13ee-40b5-a3e6-ef8f974afb5d
            email: test.aip@datakaveri.org
            name: Test AIP
            organization: Internet Widgits Pty Ltd
            address: 'Some-Place, Some-State'
            entity: CORPORATION
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        purposes:
          type: array
          items:
            $ref: '#/components/schemas/Purpose'
        dataPrincipals:
          $ref: '#/components/schemas/Data-Principal'
        expiryDuration:
          type: string
        createdAt:
          type: string
        updatedAt:
          type: string
        effectiveItemId:
          type: string
        effectiveItemType:
          type: string
        aip:
          type: object
          properties:
            id:
              type: string
              format: uuid
            email:
              type: string
            name:
              type: string
            organization:
              type: string
            address:
              type: string
            entity:
              type: string
    Revocation:
      title: Revocation
      x-stoplight:
        id: 1wz53v0rvi7s4
      type: object
      x-tags:
        - Consent Artifact Model
      x-examples:
        Example 1:
          id: b68eae1e-9c52-454e-80d7-a64d1ce706e9
          revokedBy:
            id: 530f4c2b-bc4c-4c4a-bddb-31c1ab2343fb
            name: AIP Person
            email: aip.person@example.com
            role: AIP
          revokedAt: '2023-01-24T14:15:22Z'
          signedRevocation: {}
      properties:
        id:
          type: string
          format: uuid
        revokedBy:
          allOf:
            - oneOf:
                - $ref: '#/components/schemas/AIU'
                - $ref: '#/components/schemas/AIP'
            - $ref: '#/components/schemas/Role'
        revokedAt:
          type: string
        artifact:
          $ref: '#/components/schemas/Consent-Artifact'
        signedRevocation:
          type: object
      required:
        - id
        - revokedBy
        - revokedAt
    Download-Consent-Artifact:
      title: Download-Consent-Artifact
      x-stoplight:
        id: 018uztqernzyd
      type: object
      x-tags:
        - Consent Artifact Model
      x-examples:
        Example 1:
          artifact:
            id: ee3f7aff-9306-41b6-b4dc-67ea751511f2
            aiu:
              id: 2ad34eb1-9934-4128-b3d8-acad37d0574d
              name: AIU Person
              email: aiu.person@example.com
            aip:
              id: 530f4c2b-bc4c-4c4a-bddb-31c1ab2343fb
              name: AIP Person
              email: aip.person@example.com
            dataPrincipal:
              id: baa153a1-a7f7-469b-b6cd-f7fa4581c65e
              ppbNo: T13010130532
              name: Farmer
            purposes:
              - id: 2174e669-82dd-4053-be23-e69a8ecb6d94
                code: B1
                name: Agricultural credit
                description: |-
                  - Assessment of credit worthiness and extension of short,medium, and long-term loans to farmers and the associated processes like recovery.
                  - Extending credit to farmers basing on NegotiableWarehouse Receipts (NWR)
            itemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
            itemType: resource_group
            status: revoked
            revocation:
              id: b68eae1e-9c52-454e-80d7-a64d1ce706e9
              revokedBy:
                id: 530f4c2b-bc4c-4c4a-bddb-31c1ab2343fb
                name: AIP Person
                email: aip.person@example.com
                role: AIP
              revokedAt: '2023-01-24T14:15:22Z'
              signedRevocation: {}
            expiry: '2027-08-24T14:15:22Z'
            createdAt: '2019-08-24T14:15:22Z'
            updatedAt: '2023-01-24T14:15:22Z'
          signedArtifact: {}
          accessLogs:
            - id: ab55b457-5047-41f3-81f2-05b21ff6ebd1
              artifact: ee3f7aff-9306-41b6-b4dc-67ea751511f2
              createdAt: '2022-08-24T14:15:22Z'
              signedAccessLog: {}
              effectiveItemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
              effectiveItemType: resource_group
      properties:
        artifact:
          $ref: '#/components/schemas/Consent-Artifact'
        signedArtifact:
          type: object
        accessLogs:
          type: array
          minItems: 0
          items:
            $ref: '#/components/schemas/Access-Log'
      required:
        - artifact
        - signedArtifact
        - accessLogs
    Role:
      title: Role
      x-stoplight:
        id: aeh4vzy1tgq01
      type: object
      properties:
        role:
          type: string
          enum:
            - AIU
            - AIP
      required:
        - role
      x-tags:
        - Role Model
    Agreement:
      type: object
      x-examples:
        Example 1:
          id: ee3f7aff-9306-41b6-b4dc-67ea751511f2
          aiu:
            id: 2ad34eb1-9934-4128-b3d8-acad37d0574d
            name: AIU Person
            email: aiu.person@example.com
          aip:
            id: 530f4c2b-bc4c-4c4a-bddb-31c1ab2343fb
            name: AIP Person
            email: aip.person@example.com
          purposes:
            - id: 2174e669-82dd-4053-be23-e69a8ecb6d94
              code: B1
              name: Agricultural credit
              description: |-
                - Assessment of credit worthiness and extension of short,medium, and long-term loans to farmers and the associated processes like recovery.
                - Extending credit to farmers basing on NegotiableWarehouse Receipts (NWR)
          itemId: datakaveri.org/27e503da0bdda6efae3a52b3ef423c1f9005657a/rs.iudx.org.in/resource-group
          itemType: resource_group
          itemName: title
          status: active
          expiryDuration: P1Y
          createdAt: '2019-08-24T14:15:22Z'
          updatedAt: '2019-08-24T14:15:22Z'
      properties:
        id:
          type: string
        aiu:
          $ref: '#/components/schemas/AIU'
        aip:
          $ref: '#/components/schemas/AIP'
        purposes:
          type: array
          items:
            $ref: '#/components/schemas/Purpose'
        itemId:
          type: string
        itemType:
          type: string
        itemName:
          type: string
        status:
          type: string
        expiryDuration:
          type: string
          x-stoplight:
            id: 6hs06eiy0omrt
        createdAt:
          type: string
        updatedAt:
          type: string
      title: Agreement
      x-tags:
        - Agreement Model
  securitySchemes:
    IUDX AAA Identity Token:
      type: http
      scheme: bearer
    DX Auth Server Token:
      type: http
      scheme: bearer
openapi: 3.0.0
info:
  title: Consent-Manager
  version: '1.0'
  description: Consent Manager
servers:
  - url: 'http://localhost:3000'
x-tagGroups:
  - name: General
    tags:
      - Purposes APIs
      - Consent Form APIs
      - Consent Artifact APIs
      - Data Principal APIs
      - AIU APIs
      - Access Log APIs
  - name: Models
    tags:
      - Consent Form Model
      - Purpose Model
      - Data Principal Model
      - AIU Model
      - AIP Model
      - Consent Artifact Model
      - Access Log Model
paths:
  /consent/purposes:
    parameters: []
    get:
      summary: 'Get all purposes - AIU, AIP'
      operationId: get-consent-purposes
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Purpose'
                required:
                  - type
                  - title
                  - results
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                        code: 0
                        name: string
                        description: string
      description: Get all purposes
      security:
        - IUDX AAA Identity Token: []
      tags:
        - Purposes APIs
  /consent/forms:
    parameters: []
    get:
      summary: View consent forms - AIP
      operationId: get-consent-forms
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Consent-Form'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                        name: string
                        itemId: string
                        itemType: resource_group
                        purposes:
                          - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                            code: 0
                            name: string
                            description: string
                        expiryDuration: P1Y
                        consentFormStats:
                          artifactCount: 0
                          dataPrincipals:
                            count: 0
                            uri: string
      description: AIP views all consent forms they have created
      tags:
        - Consent Form APIs
      security:
        - IUDX AAA Identity Token: []
      parameters: []
    post:
      summary: Create consent form - AIP
      operationId: post-consent-forms
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    $ref: '#/components/schemas/Consent-Form'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                      name: string
                      itemId: string
                      itemType: resource_group
                      purposes:
                        - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                          code: 0
                          name: string
                          description: string
                      expiryDuration: P1Y
                      consentFormStats:
                        artifactCount: 0
                        dataPrincipals:
                          count: 0
                          uri: string
      description: Create a consent form
      security:
        - IUDX AAA Identity Token: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                purposes:
                  type: array
                  items:
                    type: string
                    format: uuid
                dataPrincipals:
                  type: array
                  description: PPB numbers
                  items:
                    type: string
                itemId:
                  type: string
                  description: cat ID of resource
                itemType:
                  type: string
                  enum:
                    - resource_group
                    - resource
                expiryDuration:
                  type: string
              required:
                - name
                - purposes
                - dataPrincipals
                - itemId
                - itemType
                - expiryDuration
            examples:
              Example 1:
                value:
                  name: string
                  description: string
                  purposes:
                    - 497f6eca-6276-4993-bfeb-53cbbbba6f08
                  dataPrincipals:
                    - string
                  itemId: string
                  itemType: resource_group
                  expiryDuration: P1Y
      tags:
        - Consent Form APIs
    put:
      summary: Update an existing consent form - AIP
      operationId: put-consent-forms
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Consent-Form'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                        name: string
                        itemId: string
                        itemType: resource_group
                        purposes:
                          - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                            code: 0
                            name: string
                            description: string
                        expiryDuration: P1Y
                        consentFormStats:
                          artifactCount: 0
                          dataPrincipals:
                            count: 0
                            uri: string
      description: Update purposes/data principals/expiry duration
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
            examples:
              Example 1:
                value:
                  request:
                    - purposes:
                        - 0
                      expiryDuration: P1Y
                      dataPrincipals:
                        - string
                      formId: 126460ed-49b2-4c69-849a-bd8904ec5d8f
      tags:
        - Consent Form APIs
    delete:
      summary: Delete consent forms - AIP
      operationId: delete-consent-forms
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Consent-Form'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                        name: string
                        itemId: string
                        itemType: resource_group
                        purposes:
                          - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                            code: 0
                            name: string
                            description: string
                        expiryDuration: P1Y
                        consentFormStats:
                          artifactCount: 0
                          dataPrincipals:
                            count: 0
                            uri: string
      description: Delete list of consent forms
      security:
        - IUDX AAA Identity Token: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                formIds:
                  type: array
                  format: uuid
                  items:
                    type: string
                    format: uuid
            examples:
              Example 1:
                value:
                  formIds:
                    - 497f6eca-6276-4993-bfeb-53cbbbba6f08
      tags:
        - Consent Form APIs
  /consent/forms/search:
    get:
      summary: Search for resource + data principal - AIU
      tags:
        - Consent Form APIs
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    $ref: '#/components/schemas/Consent-Form-Search'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      formId: 126460ed-49b2-4c69-849a-bd8904ec5d8f
                      effectiveItemId: string
                      effectiveItemType: resource_group
                      purposes:
                        - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                          code: 0
                          name: string
                          description: string
                      expiryDuration: string
                      dataPrincipal: string
      operationId: get-consent-forms-search
      description: 'AIU can search if a consent form exists for a given resource and data principal '
      security:
        - IUDX AAA Identity Token: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                itemId:
                  type: string
                itemType:
                  type: string
                  enum:
                    - resource_group
                    - resource
                dataPrincipal:
                  type: string
              required:
                - itemId
                - itemType
                - dataPrincipal
            examples:
              Example 1:
                value:
                  itemId: string
                  itemType: resource_group
                  dataPrincipal: string
  /consent/artifacts:
    get:
      summary: 'Get all consent artifacts - AIP, AIU'
      tags:
        - Consent Artifact APIs
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Consent-Artifact'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                        aiu:
                          id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                          name:
                            firstName: string
                            lastName: string
                          email: string
                          aiuStats:
                            artifacts:
                              count: 0
                              uri: string
                            accessLogs:
                              count: 0
                              uri: string
                        aip:
                          id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                          name:
                            firstName: string
                            lastName: string
                          email: string
                        dataPrincipal:
                          id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                          ppbNo: string
                          name: string
                          dataPrincipalStats:
                            artifacts:
                              count: 0
                              uri: string
                            accessLogs:
                              count: 0
                              uri: string
                        purposes:
                          - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                            code: 0
                            name: string
                            description: string
                        itemId: string
                        itemType: resource_group
                        status: active
                        expiry: '2019-08-24T14:15:22Z'
                        createdAt: '2019-08-24T14:15:22Z'
                        consentArtifactStats:
                          accessLogs:
                            count: 0
                            uri: string
      operationId: get-consent-artifacts
      description: |-
        # AIP
        Get all consent artifacts for resources they own 

        # AIU
        Get all consent artifacts created for them
      security:
        - IUDX AAA Identity Token: []
      parameters: []
    post:
      summary: Create consent artifact - AIU
      operationId: post-consent-artifacts
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    $ref: '#/components/schemas/Consent-Artifact'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                      aiu:
                        id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                        name:
                          firstName: string
                          lastName: string
                        email: string
                        aiuStats:
                          artifacts:
                            count: 0
                            uri: string
                          accessLogs:
                            count: 0
                            uri: string
                      aip:
                        id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                        name:
                          firstName: string
                          lastName: string
                        email: string
                      dataPrincipal:
                        id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                        ppbNo: string
                        name: string
                        dataPrincipalStats:
                          artifacts:
                            count: 0
                            uri: string
                          accessLogs:
                            count: 0
                            uri: string
                      purposes:
                        - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                          code: 0
                          name: string
                          description: string
                      itemId: string
                      itemType: resource_group
                      status: active
                      expiry: '2019-08-24T14:15:22Z'
                      createdAt: '2019-08-24T14:15:22Z'
                      consentArtifactStats:
                        accessLogs:
                          count: 0
                          uri: string
      description: AIU tries to create a consent artifact for a resource + data principal. Purposes are taken from the form ID associated.
      security:
        - IUDX AAA Identity Token: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                itemId:
                  type: string
                  description: Cat ID of requested resource
                itemType:
                  type: string
                  enum:
                    - resource_group
                    - resource
                dataPrincipal:
                  type: string
                  description: PPB number
                formId:
                  type: string
                  format: uuid
              required:
                - itemId
                - itemType
                - dataPrincipal
                - formId
            examples:
              Example 1:
                value:
                  itemId: string
                  itemType: resource_group
                  dataPrincipal: string
                  formId: 126460ed-49b2-4c69-849a-bd8904ec5d8f
      tags:
        - Consent Artifact APIs
    delete:
      summary: Revoke consent artifact - AIP
      operationId: delete-consent-artifacts
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Consent-Artifact'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                        aiu:
                          id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                          name:
                            firstName: string
                            lastName: string
                          email: string
                          aiuStats:
                            artifacts:
                              count: 0
                              uri: string
                            accessLogs:
                              count: 0
                              uri: string
                        aip:
                          id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                          name:
                            firstName: string
                            lastName: string
                          email: string
                        dataPrincipal:
                          id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                          ppbNo: string
                          name: string
                          dataPrincipalStats:
                            artifacts:
                              count: 0
                              uri: string
                            accessLogs:
                              count: 0
                              uri: string
                        purposes:
                          - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                            code: 0
                            name: string
                            description: string
                        itemId: string
                        itemType: resource_group
                        status: active
                        expiry: '2019-08-24T14:15:22Z'
                        createdAt: '2019-08-24T14:15:22Z'
                        updatedAt: '2019-08-24T14:15:22Z'
                        consentArtifactStats:
                          accessLogs:
                            count: 0
                            uri: string
      description: Revoke a consent artifact owned by AIP
      security:
        - IUDX AAA Identity Token: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                artifactIds:
                  type: array
                  uniqueItems: true
                  minItems: 1
                  maxItems: 100
                  items:
                    type: string
                    format: uuid
            examples:
              Example 1:
                value:
                  artifactIds:
                    - 497f6eca-6276-4993-bfeb-53cbbbba6f08
      tags:
        - Consent Artifact APIs
  /consent/artifacts/download:
    get:
      summary: 'Download consent artifact - AIP, AIU'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Download-Consent-Artifact'
              examples: {}
      operationId: get-consent-artifacts-download
      tags:
        - Consent Artifact APIs
      description: |-
        # AIP

        Download list of consent artifacts and access logs

        # AIU

        Download list of consent artifacts and access logs
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                artifactId:
                  type: array
                  format: uuid
                  uniqueItems: true
                  minItems: 1
                  maxItems: 100
                  items:
                    type: string
                    format: uuid
              required:
                - artifactId
            examples:
              Example 1:
                value:
                  artifactId:
                    - 497f6eca-6276-4993-bfeb-53cbbbba6f08
  /consent/principals:
    get:
      summary: 'Get data principals - AIP, AIU'
      tags:
        - Data Principal APIs
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    $ref: '#/components/schemas/Data-Principal'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                      ppbNo: string
                      name: string
                      dataPrincipalStats:
                        artifactCount: 0
                        accessLogCount: 0
      operationId: get-consent-principals
      description: |-
        # AIP

        Get all data principals present in consent forms of AIP

        # AIU

        Get all data principals present in consent artifacts of AIU
      security:
        - IUDX AAA Identity Token: []
      parameters: []
    delete:
      summary: Revoke consent for data principals - AIP
      operationId: delete-consent-principals
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Data-Principal'
      description: |-
        AIPs can revoke consent for a DP
        - removes them from all consent forms the AIP owns
        - revokes all consent artifacts the DP is part of
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                principalIds:
                  type: array
                  description: UUID or PPB?
                  items:
                    type: string
            examples:
              Example 1:
                value:
                  principalIds:
                    - string
      security:
        - IUDX AAA Identity Token: []
      tags:
        - Data Principal APIs
  /consent/aius:
    get:
      summary: Get AIUs - AIPs
      tags:
        - AIU APIs
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/AIU'
      operationId: get-consent-aius
      description: AIPs can get all AIUs that have consent artifacts for their forms
    delete:
      summary: Revoke artifacts of AIUs - AIPs
      operationId: delete-consent-aius
      responses:
        '200':
          description: Returns list of revoked artifacts?
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Consent-Artifact'
      description: AIPs can send a list of AIUs whose artifacts must be revoked for forms they have created
      security:
        - IUDX AAA Identity Token: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                aiuIds:
                  type: array
                  items:
                    type: string
                    format: uuid
            examples:
              Example 1:
                value:
                  aiuIds:
                    - 497f6eca-6276-4993-bfeb-53cbbbba6f08
      tags:
        - AIU APIs
  /consent/logs:
    get:
      summary: Get artifact access logs - AIP
      tags:
        - Access Log APIs
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Access-Log'
              examples:
                Example 1:
                  value:
                    type: string
                    title: string
                    results:
                      - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
                        artifact: d314337b-6c0d-4d0e-a3b2-d6fc0160357d
                        createdAt: '2019-08-24T14:15:22Z'
                        signedAccessLog: {}
                        itemId: string
                        itemType: resource_group
      operationId: get-consent-logs
      parameters: []
components:
  schemas:
    Consent-Form:
      title: Consent-Form
      x-stoplight:
        id: ti854s4kspqie
      type: object
      x-tags:
        - Consent Form Model
      description: Consent form external view
      properties:
        id:
          type: string
          description: UUID ID of form
          format: uuid
        name:
          type: string
          description: Simple name of form
        itemId:
          type: string
          description: Cat ID of resource
        itemType:
          type: string
          description: Type of resource
          enum:
            - resource_group
            - resource
        purposes:
          type: array
          description: List of purposes
          items:
            $ref: '#/components/schemas/Purpose'
        dataPrincipals:
          type: array
          items:
            $ref: '#/components/schemas/Data-Principal'
        expiryDuration:
          type: string
          description: How long a consent artefact generated from thisform will last
          pattern: '^(-?)P(?=\d|T\d)(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)([DW]))?(?:T(?:(\d+)H)?(?:(\d+)M)?(?:(\d+(?:\.\d+)?)S)?)?$'
        consentFormStats:
          $ref: '#/components/schemas/Consent-Form-Stats'
      required:
        - id
        - name
        - itemId
        - itemType
        - purposes
        - expiryDuration
      x-examples:
        Example 1:
          id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
          name: string
          itemId: string
          itemType: resource_group
          purposes:
            - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
              code: 0
              name: string
              description: string
          dataPrincipals:
            - id: 497f6eca-6276-4993-bfeb-53cbbbba6f08
              ppbNo: string
              name: string
              dataPrincipalStats:
                artifacts:
                  count: 0
                accessLogs:
                  count: 0
          expiryDuration: P1Y
          consentFormStats:
            artifactCount: 0
            dataPrincipals:
              count: 0
    Consent-Form-Stats:
      title: Consent-Form-Stats
      x-stoplight:
        id: 32u08fgjwdk85
      type: object
      description: 'Stats for a consent form '
      x-tags:
        - Consent Form Model
      properties:
        artifacts:
          type: object
          properties:
            count:
              type: integer
        dataPrincipals:
          type: object
          properties:
            count:
              type: integer
      x-examples:
        Example 1:
          artifacts:
            count: 100
          dataPrincipals:
            count: 2
    PurposeCode:
      title: PurposeCode
      x-stoplight:
        id: a3gdxlwhpe33h
      type: string
      description: Allowed codes for ADeX purposes
      x-examples:
        Example 1: B1
      example: B1
      enum:
        - B1
        - B2
        - B3
        - B4
        - B5
        - B6
        - '_1'
        - P2
        - P3
        - P4
        - P5
        - G1
        - G2
        - G3
        - G4
        - G5
        - G6
      x-tags:
        - Purpose Model
    Purpose:
      title: Purpose
      x-stoplight:
        id: jyhjlpu5iug53
      type: object
      x-tags:
        - Purpose Model
      properties:
        id:
          type: string
          description: UUID ID of purpose
          format: uuid
        code:
          $ref: '#/components/schemas/PurposeCode'
        name:
          type: string
        description:
          type: string
      required:
        - id
        - code
        - name
      description: ''
      x-examples:
        Example 1:
          id: 2174e669-82dd-4053-be23-e69a8ecb6d94
          code: B1
          name: Agricultural credit
          description: |-
            - Assessment of credit worthiness and extension of short,medium, and long-term loans to farmers and the associated processes like recovery.
            - Extending credit to farmers basing on NegotiableWarehouse Receipts (NWR)
    Data-Principal-Stats:
      title: Data-Principal-Stats
      x-stoplight:
        id: rff0j8ljamfv8
      type: object
      x-tags:
        - Data Principal Model
      properties:
        artifacts:
          type: object
          properties:
            count:
              type: integer
        accessLogs:
          type: object
          properties:
            count:
              type: integer
      x-examples:
        Example 1:
          artifacts:
            count: 0
          accessLogs:
            count: 0
    Data-Principal:
      title: Data-Principal
      x-stoplight:
        id: ydql93jmjxe2a
      type: object
      x-tags:
        - Data Principal Model
      properties:
        id:
          type: string
          description: UUID ID of data principal
          format: uuid
        ppbNo:
          $ref: '#/components/schemas/PPBNo'
        name:
          type: string
          description: Name in English
        dataPrincipalStats:
          $ref: '#/components/schemas/Data-Principal-Stats'
      required:
        - id
        - ppbNo
        - name
      x-examples:
        Example 1:
          id: baa153a1-a7f7-469b-b6cd-f7fa4581c65e
          ppbNo: T13010130532
          name: Farmer
          dataPrincipalStats:
            artifacts:
              count: 4
            accessLogs:
              count: 9
    PPBNo:
      title: PPBNo
      x-stoplight:
        id: 31lsvpan6jmty
      type: string
      description: A PPB number
      example: T13010130532
      x-examples:
        Example 1: T13010130532
    AIU:
      title: AIU
      x-stoplight:
        id: 30c8733454a35
      type: object
      x-tags:
        - AIU Model
      properties:
        id:
          type: string
          description: IUDX user ID of AIU
          format: uuid
        name:
          type: string
        email:
          type: string
        aiuStats:
          $ref: '#/components/schemas/AIU-Stats'
      required:
        - id
        - name
        - email
      x-examples:
        Example 1:
          id: 2ad34eb1-9934-4128-b3d8-acad37d0574d
          name: AIU Person
          email: aiu.person@example.com
          aiuStats:
            artifacts:
              count: 0
            accessLogs:
              count: 0
    AIU-Stats:
      title: AIU-Stats
      x-stoplight:
        id: ojnrtjbu9ojop
      type: object
      x-tags:
        - AIU Model
      properties:
        artifacts:
          type: object
          properties:
            count:
              type: integer
        accessLogs:
          type: object
          properties:
            count:
              type: integer
      x-examples:
        Example 1:
          artifacts:
            count: 4
          accessLogs:
            count: 1
    AIP:
      title: AIP
      x-stoplight:
        id: h80aoxodvm5r8
      type: object
      x-tags:
        - AIP Model
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        email:
          type: string
      required:
        - id
        - name
        - email
      x-examples:
        Example 1:
          id: 530f4c2b-bc4c-4c4a-bddb-31c1ab2343fb
          name: AIU Person
          email: aiu.person@example.com
    Consent-Artifact:
      title: Consent-Artifact
      x-stoplight:
        id: q0amvhva2o2fb
      type: object
      x-tags:
        - Consent Artifact Model
      properties:
        id:
          type: string
          description: UUID ID of artifact
          format: uuid
        aiu:
          $ref: '#/components/schemas/AIU'
        aip:
          $ref: '#/components/schemas/AIP'
        dataPrincipal:
          $ref: '#/components/schemas/Data-Principal'
        purposes:
          type: array
          items:
            $ref: '#/components/schemas/Purpose'
        itemId:
          type: string
        itemType:
          type: string
          enum:
            - resource_group
            - resource
        status:
          type: string
          enum:
            - active
            - revoked
        expiry:
          type: string
          format: date-time
        createdAt:
          type: string
          format: date-time
        consentArtifactStats:
          $ref: '#/components/schemas/Consent-Artifact-Stats'
      required:
        - id
        - aiu
        - aip
        - dataPrincipal
        - purposes
        - itemId
        - itemType
        - status
        - expiry
        - createdAt
      x-examples: {}
    Consent-Artifact-Stats:
      title: Consent-Artifact-Stats
      x-stoplight:
        id: vimv51qjgikhf
      type: object
      x-tags:
        - Consent Artifact Model
      properties:
        accessLogs:
          type: object
          properties:
            count:
              type: integer
    Access-Log:
      title: Access-Log
      x-stoplight:
        id: 863xx35dw6y26
      type: object
      x-tags:
        - Access Log Model
      properties:
        id:
          type: string
          format: uuid
        artifact:
          anyOf:
            - type: string
              format: uuid
            - $ref: '#/components/schemas/Consent-Artifact'
        createdAt:
          type: string
          format: date-time
        signedAccessLog:
          type: object
        itemId:
          type: string
        itemType:
          type: string
          enum:
            - resource_group
            - resource
      required:
        - id
        - artifact
        - createdAt
        - itemId
        - itemType
    Consent-Form-Search:
      title: Consent-Form-Search
      x-stoplight:
        id: hr5tg674z8wgh
      type: object
      properties:
        formId:
          type: string
          format: uuid
        effectiveItemId:
          type: string
        effectiveItemType:
          type: string
          enum:
            - resource_group
            - resource
        purposes:
          type: array
          items:
            $ref: '#/components/schemas/Purpose'
        expiryDuration:
          type: string
        dataPrincipal:
          type: string
    Revocation:
      title: Revocation
      x-stoplight:
        id: 1wz53v0rvi7s4
      type: object
      properties:
        id:
          type: string
          format: uuid
        revokedBy:
          $ref: '#/components/schemas/AIP'
        role:
          type: string
          enum:
            - AIP
            - AIU
        artifact:
          anyOf:
            - type: string
              format: uuid
            - $ref: '#/components/schemas/Consent-Artifact'
        signedRevocation:
          type: object
      required:
        - id
        - revokedBy
        - role
        - artifact
    Download-Consent-Artifact:
      title: Download-Consent-Artifact
      x-stoplight:
        id: 018uztqernzyd
      type: object
      properties:
        artifact:
          $ref: '#/components/schemas/Consent-Artifact'
        signedArtifact:
          type: object
        revocation:
          $ref: '#/components/schemas/Revocation'
        accessLogs:
          type: array
          minItems: 0
          items:
            $ref: '#/components/schemas/Access-Log'
      required:
        - artifact
        - signedArtifact
        - accessLogs
      x-tags:
        - Consent Artifact Model
  securitySchemes:
    IUDX AAA Identity Token:
      type: http
      scheme: bearer
